!function(){"use strict";function e(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}class t{constructor({themeName:t,isDarkTheme:o,variables:r,rules:n,monacoTheme:i,rootTheme:c=""}){e(this,"_themeName",void 0),e(this,"_variables",void 0),e(this,"_rules",void 0),e(this,"_monacoTheme",void 0),e(this,"_rootTheme",void 0),e(this,"isDarkTheme",void 0),this._themeName=t,this.isDarkTheme=o,this._variables=r,this._rules=n,this._monacoTheme=i,this._rootTheme=c}get css(){return t._cssBuilder(this._rules,this._variables)}get monacoTheme(){return this._monacoTheme?t._monacoThemeBuilder(this._monacoTheme,this._variables):void 0}get hasMonacoTheme(){return!!this._monacoTheme}get themeName(){return this._themeName}get rootTheme(){return this._rootTheme}get variables(){return this._variables}static _cssBuilder(e,t){let o="";for(let r in e){const n=e[r];let i="";for(let e in n)i+=`${e}:${n[e].replace(/{{([^}{]+?)}}/g,((e,o)=>o in t?t[o]:e))};`;o+=`${r}{${i}}`}return o}static _monacoThemeBuilder(e,t){function o(e){if(!e)return;const o=t[e];return o?o.replace(/^#/,""):e}return{base:e.base,inherit:e.inherit,rules:e.rules.map((e=>{const t={...e};let r=o(e.foreground),n=o(e.background);return r&&(t.foreground=r),n&&(t.background=n),t})),colors:Object.keys(e.colors).reduce(((o,r)=>(o[r]=t[e.colors[r]]||e.colors[r],o)),{})}}toObject(){return{rootTheme:this._rootTheme,themeName:this._themeName,variables:this._variables,rules:this._rules,monacoTheme:this._monacoTheme}}toJSON(){return JSON.stringify(this.toObject())}createFrom({themeName:e,variables:o={},rules:r={}}){const n=this._themeName,i=new t({themeName:e,isDarkTheme:this.isDarkTheme,variables:{...this._variables,...o},rules:{...this._rules,...r},rootTheme:n,monacoTheme:this._monacoTheme});return i.toObject=function(){return{rootTheme:n,themeName:e,variables:o,rules:r,monacoTheme:void 0}},i}}const o=new t({themeName:"Darcula",isDarkTheme:!0,variables:{IDE_code_background:"#2B2B2B",IDE_code_comment:"#888888",IDE_code_comment_doc:"#6a9955",IDE_code_string:"#6a8759",IDE_code_keyword:"#cc7832",IDE_code_number:"#6897bb",IDE_code_class:"#ffc66d",IDE_code_identifier:"#b589cc",IDE_code_delimiter:"#bbbbbb",IDE_code_regex:"#ff5500",IDE_code_html_tag:"#ffc66d",IDE_code_html_attribute:"#A772D0",IDE_code_css_selector:"#FF861E"},rules:{".monaco-editor .reference-zone-widget .preview .reference-decoration":{"background-color":"#864b00b3"}},monacoTheme:{base:"vs-dark",inherit:!0,rules:[{background:"IDE_code_background",token:""},{foreground:"IDE_code_comment",token:"comment"},{foreground:"IDE_code_comment_doc",token:"comment.doc"},{foreground:"IDE_code_string",token:"string"},{foreground:"IDE_code_number",token:"number"},{foreground:"IDE_code_keyword",token:"keyword"},{foreground:"IDE_code_identifier",token:"identifier"},{foreground:"IDE_code_class",token:"type.identifier"},{foreground:"IDE_code_delimiter",token:"delimiter"},{foreground:"IDE_code_regex",token:"regexp"},{foreground:"IDE_code_html_tag",token:"tag.html"},{foreground:"IDE_code_html_attribute",token:"attribute.name.html"},{foreground:"IDE_code_string",token:"attribute.value.html"},{foreground:"IDE_code_comment",token:"metatag.html"},{foreground:"IDE_code_comment",token:"metatag.content.html"},{foreground:"IDE_code_css_selector",token:"tag.css"},{foreground:"IDE_code_html_attribute",token:"attribute.name.css"},{foreground:"IDE_code_string",token:"attribute.value.css"},{foreground:"IDE_code_identifier",token:"string.key.json"},{foreground:"IDE_code_string",token:"string.value.json"}],colors:{"editor.foreground":"#bbbbbb","editor.background":"IDE_code_background","editor.selectionBackground":"#49483E","editor.lineHighlightBackground":"#3E3D32","editorCursor.foreground":"#F8F8F0","editorWhitespace.foreground":"#3B3A32","editorIndentGuide.activeBackground":"#9D550FB0","editor.selectionHighlightBorder":"#222218"}}}),r=o.createFrom({themeName:"BlackFoxConsole",variables:{IDE_code_background:"#14171A",IDE_code_comment:"#5C6773",IDE_code_comment_doc:"#6a9955",IDE_code_string:"#BC8154",IDE_code_keyword:"#bbaa44",IDE_code_number:"#5F9F5B",IDE_code_class:"#3689B2",IDE_code_identifier:"#b589cc",IDE_code_delimiter:"#CDD7E0",IDE_code_regex:"#ff5500",IDE_code_html_tag:"#A673BF",IDE_code_html_attribute:"#3689B2",IDE_code_css_selector:"#555555"}});new t({themeName:"Default",isDarkTheme:!1,variables:{},rules:{}}),o.createFrom({themeName:"OneDark",variables:{IDE_code_background:"#31343f",IDE_code_comment:"#616e88",IDE_code_comment_doc:"#6a9955",IDE_code_string:"#a3be8c",IDE_code_keyword:"#81a1c1",IDE_code_number:"#6897bb",IDE_code_class:"#f1f1f1",IDE_code_identifier:"#b589cc",IDE_code_delimiter:"#bbbbbb",IDE_code_regex:"#d08770",IDE_code_html_tag:"#ebcb8b",IDE_code_html_attribute:"#8fbcbb",IDE_code_css_selector:"#8fbcbb"}});const n=new t({themeName:"Monokai",isDarkTheme:!0,variables:{IDE_code_comment_doc:"#6a9955"},rules:{".monaco-editor .reference-zone-widget .preview .reference-decoration":{"background-color":"#864b00b3"}},monacoTheme:{base:"vs-dark",inherit:!0,rules:[{background:"272822",token:""},{foreground:"75715e",token:"comment"},{foreground:"IDE_code_comment_doc",token:"comment.doc"},{foreground:"e6db74",token:"string"},{foreground:"ae81ff",token:"constant.numeric"},{foreground:"ae81ff",token:"constant.language"},{foreground:"ae81ff",token:"constant.character"},{foreground:"ae81ff",token:"constant.other"},{foreground:"f92672",token:"keyword"},{foreground:"f92672",token:"storage"},{foreground:"66d9ef",fontStyle:"italic",token:"storage.type"},{foreground:"a6e22e",fontStyle:"underline",token:"entity.name.class"},{foreground:"a6e22e",fontStyle:"italic underline",token:"entity.other.inherited-class"},{foreground:"a6e22e",token:"entity.name.function"},{foreground:"fd971f",fontStyle:"italic",token:"variable.parameter"},{foreground:"f92672",token:"entity.name.tag"},{foreground:"a6e22e",token:"entity.other.attribute-name"},{foreground:"66d9ef",token:"support.function"},{foreground:"66d9ef",token:"support.constant"},{foreground:"66d9ef",fontStyle:"italic",token:"support.type"},{foreground:"66d9ef",fontStyle:"italic",token:"support.class"},{foreground:"f8f8f0",background:"f92672",token:"invalid"},{foreground:"f8f8f0",background:"ae81ff",token:"invalid.deprecated"},{foreground:"cfcfc2",token:"meta.structure.dictionary.json string.quoted.double.json"},{foreground:"75715e",token:"meta.diff"},{foreground:"75715e",token:"meta.diff.header"},{foreground:"f92672",token:"markup.deleted"},{foreground:"a6e22e",token:"markup.inserted"},{foreground:"e6db74",token:"markup.changed"},{foreground:"ae81ffa0",token:"constant.numeric.line-number.find-in-files - match"},{foreground:"e6db74",token:"entity.name.filename.find-in-files"}],colors:{"editor.foreground":"#F8F8F2","editor.background":"#272822","editor.selectionBackground":"#49483E","editor.lineHighlightBackground":"#3E3D32","editorCursor.foreground":"#F8F8F0","editorWhitespace.foreground":"#3B3A32","editorIndentGuide.activeBackground":"#9D550FB0","editor.selectionHighlightBorder":"#222218"}}}),i="EVENT_ASC_ACTION",c=e=>{window.dispatchEvent(new CustomEvent(i,{detail:e}))};let a;!function(e){e.ALL_THEME_CHANGED="ALL_THEME_CHANGED",e.CS_INSERT_THEME_ACTION="CS_INSERT_THEME_ACTION",e.CS_SET_THEME="CS_SET_THEME",e.CS_RESET_THEME="CS_RESET_THEME",e.MAIN_MONACO_READY="MAIN_MONACO_READY",e.MAIN_THEME_CHANGED="MAIN_THEME_CHANGED"}(a||(a={}));const s=new class{constructor(){e(this,"_storagePrefix","appScriptColor")}getThemeInUse(){return this._getSetting("theme")}setThemeInUse(e){this._setSetting("theme",void 0,e),c({action:a.ALL_THEME_CHANGED,themeName:e})}useTheme(e){if(void 0!==e)return this._setSetting("theme","useTheme",""+e),e;try{return!!JSON.parse(this._getSetting("theme","useTheme"))}catch(e){return!0}}getCustomThemes(){try{return JSON.parse(this._getSetting("theme","custom")||"{}")}catch(e){return{}}}setCustomThemes(e){return this._setSetting("theme","custom",JSON.stringify(e))}getFolderStates(e){try{return JSON.parse(this._getSetting("static",`Folders-${e}`)||"{}")}catch(e){return{}}}setFolderStates(e,t){return this._setSetting("static",`Folders-${e}`,JSON.stringify(t))}_buildSettingKey(e,t){return[this._storagePrefix,e,t].filter((e=>!!e)).join("-")}_setSetting(e,t,o){localStorage.setItem(this._buildSettingKey(e,t),o)}_getSetting(e,t){return localStorage.getItem(this._buildSettingKey(e,t))}};class d{constructor(){e(this,"_isMonacoInitialized",!1),e(this,"_pendingAction",void 0),this._init()}initializeThemes(){[n,o,r].forEach((e=>{(e=>{window.jsWireMonacoEditor?._themeService._knownThemes.has(e.themeName)||window.monaco.editor.defineTheme(e.themeName,e.monacoTheme)})(e),(e=>{const t=`asc-set-theme-${e.themeName.toLowerCase()}`;window.jsWireMonacoEditor._actions[t]||window.jsWireMonacoEditor.addAction({id:t,label:`AppsScriptColor: Use ${e.isDarkTheme?"dark":"light"} theme: ${e.themeName}`,precondition:null,keybindingContext:null,contextMenuGroupId:"navigation",contextMenuOrder:1/0,run:()=>{window.monaco.editor.setTheme(e.themeName),s.setThemeInUse(e.themeName)}})})(e)}))}resetTheme(){this.setTheme()}setTheme(e){window.monaco.editor.setTheme(e??"apps-script-light")}_init(){window.addEventListener(i,(e=>{this._onAscAction(e.detail)})),this._waitForMonaco().then((()=>{this.initializeThemes(),this._isMonacoInitialized=!0,c({action:a.MAIN_MONACO_READY}),this._onAscAction(void 0)}))}async _waitForMonaco(){if(!window.monaco||!window.jsWireMonacoEditor)return new Promise((e=>{const t=new MutationObserver((o=>{o.some((o=>!!Array.from(o.addedNodes).find((e=>!("STYLE"!==e.tagName||!e.classList.contains("monaco-colors"))))&&(t.disconnect(),e(),!0)))}));t.observe(document.head,{childList:!0,attributes:!1,characterData:!1})}))}_onAscAction(e){if(!this._isMonacoInitialized)return void(this._pendingAction=e);if(!e&&!this._pendingAction)return;const t=e??this._pendingAction;switch(this._pendingAction=void 0,t.action){case a.CS_INSERT_THEME_ACTION:this.initializeThemes();break;case a.CS_RESET_THEME:this.resetTheme();break;case a.CS_SET_THEME:this.setTheme(t.themeName??void 0)}}static init(){window.__ascInAppService__||(window.__ascInAppService__=new d)}}d.init()}();
